<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: OPSEC | Hacker OPSEC]]></title>
  <link href="http://grugq.github.com/blog/categories/opsec/atom.xml" rel="self"/>
  <link href="http://grugq.github.com/"/>
  <updated>2013-12-21T07:25:35+07:00</updated>
  <id>http://grugq.github.com/</id>
  <author>
    <name><![CDATA[the grugq]]></name>
    <email><![CDATA[the.grugq@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Yardbird's Effective Usenet Tradecraft]]></title>
    <link href="http://grugq.github.com/blog/2013/12/01/yardbirds-effective-usenet-tradecraft/"/>
    <updated>2013-12-01T07:15:00+07:00</updated>
    <id>http://grugq.github.com/blog/2013/12/01/yardbirds-effective-usenet-tradecraft</id>
    <content type="html"><![CDATA[<h1>Survival in an Extremely Adversarial Environment</h1>

<blockquote><p>If your secure communications platform isn't being used by terrorists and pedophiles, you're probably doing it wrong. -- [REDACTED]</p></blockquote>

<p>A few years ago a group of child pornographers was infiltrated by police who were
able to monitor, interact, and aggressively investigate the members. Despite
engaging in a 15 month undercover operation, only one in three of the pedophiles
were successfully apprehended. The majority, including the now infamous leader
<em>Yardbird</em>, escaped capture. The dismal success rate of the law enforcement
officials was due entirely to the strict security rules followed by the group.</p>

<p>This post will examine those rules, the reasons for their success, and the
problems the group faced which necessitated those rules.</p>

<p>(An examination of the group's security from a slightly different perspective
was conducted by <code>Baal</code> and is available <a href="http://dee.su/uploads/baal.html">here</a>)</p>

<h2>Covert Organizations, Seen One, Seen 'em All</h2>

<p>All covert organizations face a similar set of problems as they attempt to execute
on their fundamental mission -- to <strong>continue to exist</strong>. A covert organization
in an adversarial environment faces a number of organizational challenges and
constraints. Fundamentally how it handles trade-offs between operational
security and efficiency mandates how group members perform their operational
activities. Strong OPSEC means low efficiency, while high efficiency necessitates
weak OPSEC. The strength of the oppositional forces dictate the minimum security
requirements of the covert organization.</p>

<p>Examining the operational activities -- those actions the organization must engage
in to self perpetuate -- allows us to evaluate their operational security decisions
within their environmental context.</p>

<h3>Operational Activities:</h3>

<p>The <em>Yardbird</em> child abuse content group (hereafter also called the <em>enterprise</em>)
had a number of core goals that had to be addressed to continue operation: they
needed to distribute their child abuse content to members; communicate between
members; raise funds to acquire new content; recruit new members (presumably for
access to additional child abuse content).</p>

<p>Explicitly stated, this is an enumerated list of the operational activities that
the group <strong>had</strong> to engage in to self perpetuate.</p>

<ol>
<li>Distribution of Child Abuse Content</li>
<li>Communication and Coordinate Action</li>
<li>Fund raising</li>
<li>Recruitment and Vetting</li>
</ol>


<p>Except for the first issue (strategically significant only to this group),
these are pretty typical activities for a clandestine organization. Besides their
defining operational activity, they need a communications channel, fund raising
capability, and membership management processes.</p>

<h2>Opposition Success: The Penetration</h2>

<p>The law enforcement authorities caught a pedophile distribution child abuse
content. He is a member of the <em>Yardbird</em> group and offers up complete access
to the group, along with archival logs, in exchange for leniency.</p>

<p>All of the information about this group comes from the <a href="https://drive.google.com/file/d/0Bzt0K7_O4qyqMi0ycjZFdzhxYTA/edit?usp=sharing">Castleman Affidavit</a>,
the <code>Baal</code> <a href="http://dee.su/uploads/baal.html">analysis</a>, and some <code>Baal</code> <a href="http://alt.privacy.anon-server.narkive.com/VRl3dTFH/the-fourth-of-yardbird-s-chums-grabs-his-ankles">follow ups</a>.</p>

<h2>A Frustrating Infiltration</h2>

<p>The law enforcement authorities were about to completely penetrate the <em>enterprise</em>
for a 15 month period from 2006-08-31 through 2007-12-15. During that time the
group's posted 400,000 images and 1,1000 videos. The <em>enterprise</em> had approximately
45 active members, although <a href="http://alt.privacy.anon-server.narkive.com/VRl3dTFH/the-fourth-of-yardbird-s-chums-grabs-his-ankles">independent observers</a> have claimed this is low with
the real membership anywhere from 48 to 61.</p>

<p>The total number of arrests was 14, or somewhere around 1/3rd. A fully staffed,
highly motivated, well trained adversarial force with complete penetration of
a large complacent group was only about to achieve a one in three success rate.
The majority of those successes were achieved due to group members being insufficiently
cautious and violating the <em>enterprise</em> security rules. Obviously, these security
rules are extremely resilient against adversarial assault.</p>

<p>The members who were caught were those who violated the security SOP of the group:</p>

<ul>
<li>Accessing a newsgroup server without using Tor (e.g. VPN, or directly)</li>
<li>Revealing personal details about themselves</li>
<li>Contacting each other outside the group's secure comms channel</li>
</ul>


<h2>Operational Activity: Distribution</h2>

<p>The <em>enterprise</em> was careful to ensure that the location of the encrypted files
containing child abuse images was a different newsgroup from the communications
newsgroup. One possible reason is to unlink the obvious encrypted group discussion
from the larger encrypted content posts. That is, they compartmented their
commo from their file sharing. As an additional, although superfluous step, the
<em>enterprise</em> would apparently alter the sequence number of the split binary
uploads so that reassembly would be hampered. What this cumbersome step added
beyond the existing PGP encryption is unclear (if your adversary can break PGP
they can probably figure out the order some files).</p>

<h2>Operational Activity: Communications</h2>

<p>The <em>enterprise</em> would use the primary newsgroup, at the start of the investigation
<code>alt.anonymous.messages</code>, to announce the location of a media cache for group
members. The communications newsgroup is always reserved strictly for communications.
The announcements regarding new downloads provided detailed instructions as to
the location of the child abuse content, plus how to download, assemble and decrypt it.</p>

<p>The group used a single shared PGP key for all members. On the one hand, this
would completely negate the security provided by PGP if the key falls into the
wrong hands. It also limits the groups ability to expel a member who transgresses
the rules and needs to be punished. On the other hand, the use of a shared key
makes key management significantly easier which is a serious concern when you
need to rekey every few months. Additionally, using only one key reduces the
ability of the adversary to determine group size by examining the PGP packets.
It also removes the potential for a group member to reuse a key that is linked
to their real identity. See <a href="http://ritter.vg/blog-deanonymizing_amm.html">this excellent</a> presentation for more details on those attacks.</p>

<h2>Operational Activity: Recruitment</h2>

<p>The <em>enterprise</em> expanded by allowing new members to join. There were clear
guidelines, procedures and rules for expansion. First there was a background
check to ensure that the prospective member was an established and active
participant in the wider community of child abuse image traders. Then an existing
member has to invite the prospect to the group. Finally, to demonstrate both
their deep involvement in the activity and to prove they are not an undercover
cop, they must pass a timed written test on the minutiae of various child abuse
victims and media.</p>

<h3>Vetting</h3>

<ul>
<li>Demonstrate active participation in the "trading scene"</li>
<li>Invited by existing member</li>
<li>Must exhibit deep domain specific knowledge via timed written test</li>
</ul>


<h2>Security Rules that Work</h2>

<ul>
<li>Never reveal true identity to another member of the group</li>
<li>Never communicate with another member of the group outside the usenet channel</li>
<li>Group membership remains strictly within the confines of the Internet

<ul>
<li>No member can positively identify another</li>
</ul>
</li>
<li>Members do not reveal personally identifying information</li>
<li>Primary communications newsgroup is migrated regularly

<ul>
<li>If a member violates a security rule, e.g. fails to encrypt a message</li>
<li>Periodically to reduce chance of law enforcement discovery</li>
</ul>
</li>
<li>On each <strong>newsgroup migration</strong>

<ul>
<li>Create new PGP key pair, unlinking from previous messages</li>
<li>Each member creates a new nickname

<ul>
<li>Nickname theme selected by <em>Yardbird</em></li>
</ul>
</li>
</ul>
</li>
</ul>


<h2>Root of Success</h2>

<p>The reason the majority of the group was able to avoid capture was in a small way
due to the technology they were using (Tor), but primarily it was adherence to the
security rules of the group. They had very good OPSEC and they followed it
consistently. Fundamentally, they had complete compartmentation within the group
-- they did not reveal information to each other. The
law enforcement authorities were able to get logs of all their communications
traffic, plus logs of their IP addresses they used for posting. Everyone that
used Tor (as per the recommendation of <em>Yardbird</em>) was anonymous at the IP
layer. This protected them from a subpoena revealing their identity. As long as
there was no additional information that they had revealed about themselves in
their messages, they were secure against the opposition.</p>

<p>The use of PGP was essentially a No-OP in this case. It excluded the general
public from accessing the content of the communications traffic (and the child
abuse videos and images). It did not protect the traffic against analysis by the
opposition (who had successfully infiltrated the group). The encryption was not
a factor in their successful evasion. Rather, it was the content of the messages,
controlled and dictated by the security rules, which protected their secrets.</p>

<h2>Lessons Learned</h2>

<p>Guarding secrets involves not sharing them. Encryption can only ever protect the
content of a communique. Real security must start with the content itself, and
then use encryption as an additional layer.</p>

<h3>Note from the Editor</h3>

<p>(Feel free to skip this part if you don't think studying how child pornographers
avoid capture is relevant)</p>

<p>When analyzing the activities of groups operating in an adversarial environment to learn what works, what doesn't, and why, (unfortunately) the pool of covert organisations is somewhat limited: intelligence agencies; terrorist groups; hacker crews; narcos; insurgents; child pornographers... Few other groups face such a hostile operating environment that their security measures are really "tested".</p>

<p>The group examined in this post had an incredibly effective set of security practices. They imposed strict compartmentation, regularly migrated identities and locations, required consistent Tor and PGP use, etc. They had legitimate punishments for people who transgressed the rules (expulsion) and they survived a massive investigation effort. Clearly, they were doing something right (actually a number of things).
Just as clearly, they are reprehensible people who engage in activity that is immoral and unethical, by any measure. (Paying for child pornography to be produced is flat out wrong, regardless on where you stand on the spectrum of <a href="http://falkvinge.net/2012/05/23/cynicism-redefined-why-the-copyright-lobby-loves-child-porn/">opinions regarding child porn laws</a>).</p>

<p>The thing is, there are basically no nice people who provide case studies of OPSEC practices. Most are engaged in violence, serious drug trafficking (at the "kill people for interfering" level), theft and manipulation of human beings, etc. Thats the nature of the beast.</p>

<p>People with well funded, trained and motivated adversaries have the strongest incentives to practice the highest level of security. They're the ones to learn from.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Win at Kung Fu and Hacking]]></title>
    <link href="http://grugq.github.com/blog/2013/11/22/challenges-for-hackers/"/>
    <updated>2013-11-22T20:02:00+07:00</updated>
    <id>http://grugq.github.com/blog/2013/11/22/challenges-for-hackers</id>
    <content type="html"><![CDATA[<h2>Everybody Was Hack Foo Fighting</h2>

<p>I'm going to discuss a serious problem with the organisational structure and
social dynamics of the hacker community, and why this puts hackers at risk.
Hackers operate essentially the same way as the henchmen in a kung fu movie:
they attack the adversary one by one by one... always losing. This is a terrible
way of developing a robust core of knowledge about which OPSEC techniques work,
which techniques fail, and why.</p>

<h2>Organisational Learning for Dummies</h2>

<p>There are two types of knowledge: individual, and organisational. Hackers are
very individualistic, and the knowledge they acquire tends to be very
practical; experience based. There are few hacker organisations that seek to
collect, retain, test and spread knowledge. The organistations that do crop up
are either some zines, which are knowledge artefacts that transmit techne, or
hacker groups, which share tool chains and experience. However, these hacker
groups have very short lifespans (measured in months and single digit years,
not decades). They are compartmented in that there is some effort made to
retain the group's proprietary information, but internally they usually
have a very poor security posture. They are social groups in many ways, so
they are heavily compromised. As we say in infosec "crunchy on the outside,
chewy in the middle".</p>

<p>Their opposition, the intelligence agencies and law enforcement departments,
have decades of organisational history and knowledge. The individual members
can display wide ranges of skill and competence, but the resources and core
knowledge of the organisation dwarf what any individual hacker has available.
Many of the skills that a hacker needs to learn, his clandestine tradecraft
and OPSEC, are the sort of skills that organisations are excellent at
developing and disseminating. These are not very good skillsets for an
individual to learn through trial and error, because those errors have
significant negative consequences. An organisation can afford to lose people
as it learns how to deal with the adversary; an individual cannot afford to
make a similar sacrifice -- afterall, who would benefit from your negative
example?</p>

<h2>Challenges? More Like Opportunities!</h2>

<p>Hackers are facing some very serious challenges now:</p>

<ul>
<li>they lack organistations for collecting intelligence and knowledge about their adversary;</li>
<li>they face off against the adversary one at a time,</li>
<li>they learn very poorly from prior mistakes</li>
<li>they don't even know what skills they need,</li>
<li>and perhaps most dangerously, they aren't even aware they're in the game</li>
</ul>


<p>It is amusing how many people think that interrogations involve violence and
torture. Successful elicitation far more frequently involves whiskey,
flattery, playing dumb, and being doubtful ("<em>really? I didn't know it was
possible to do that. You must be pretty damn smart to have figured it
out...</em>").</p>

<h2>Winning at Secrets</h2>

<p>There needs to be more information available on the techniques used during
investigations, as well as before they begin. There needs to be documentation
on how to evade those techniques, and why those evasions are successful. That
knowledge needs to be captured and dissemminated out to those who can use it.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[required reading]]></title>
    <link href="http://grugq.github.com/blog/2013/11/06/required-reading/"/>
    <updated>2013-11-06T07:23:00+07:00</updated>
    <id>http://grugq.github.com/blog/2013/11/06/required-reading</id>
    <content type="html"><![CDATA[<p>This is a short list of articles and papers that you absolutely must read if you want to understand OPSEC.</p>

<ul>
<li><p><a href="http://repository.library.georgetown.edu/bitstream/handle/10822/553096/mobleyBlake.pdf?sequence=1">Terrorist Group Counterintelligence</a> :: This is the thesis which later became the book <a href="http://www.amazon.com/Terrorism-Counterintelligence-Terrorist-Detection-Irregular/dp/0231158769">Terrorism and Counterintelligence</a>. Read at least one of them (the thesis is free).</p></li>
<li><p><a href="http://www.oss.net/dynamaster/file_archive/100102/0a947a77d762061cc87ec541c2d2dcc7/2010-01-02%20Dulles%20on%20Tradecraft%20via%20Srodes.pdf">Allen Dulles's 73 Rules of Spycraft</a> :: This is the handbook of how to live and operate securely. It is 50 years old and it has aged remarkably well. Read it. Study it. This will be on the test.</p></li>
<li><p><a href="http://www.dtic.mil/cgi-bin/GetTRDoc?AD=ADA505161">Clandestine Cellular Networks</a> :: This paper deals primarily with the lessons learned from fighting insurgents, but it is extremely valuable as a handbook on tradecraft. I previously posted just the tradecraft <a href="http://grugq.github.io/resources/tradecraft-howto.pdf">chapter</a> for people who don't want to slog through all of it. I suggest reading all of it.</p></li>
<li><p><a href="http://igcc3.ucsd.edu/research/security/DACOR/presentations/Shapiro.pdf">The Terrorists Challenge: Security, Efficiency, Control</a> :: This paper examines the primary trade offs that need to be made when operating a covert organisation. If you have multiple people working in secret, managing them and their work requires making tradeoffs between security, efficiency and control. This paper will help you to understand those tradeoffs.</p></li>
</ul>


<h3>Optional</h3>

<ul>
<li><a href="http://www.tandfonline.com/doi/pdf/10.1080/10576100802670803">A Study of al Quaeda's use of Intelligence and Counterintelligence</a> :: This pulls a lot of the information above into a single case study of a covert (terrorist) organisation planning and conducting an operation. Anything else you can lay your hands on by the author I recommend as well.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Morris Worm OPSEC lessons]]></title>
    <link href="http://grugq.github.com/blog/2013/11/06/morris-worm-opsec-lessons/"/>
    <updated>2013-11-06T04:08:00+07:00</updated>
    <id>http://grugq.github.com/blog/2013/11/06/morris-worm-opsec-lessons</id>
    <content type="html"><![CDATA[<h2>25th Anniversary of STFU about your computer crimes</h2>

<p>Reading <a href="http://www.washingtonpost.com/blogs/the-switch/wp/2013/11/05/heres-what-the-morris-worm-prosecutor-thinks-about-aaron-swartz/">this interview</a> with the prosecutor of Robert Morris Jr about the Morris Worm there are a few cool OPSEC lessons we can learn.</p>

<h2>How was Morris caught?</h2>

<blockquote><p>One way was with computer forensics. Tracing back the source of the worm. The second way was one of Morris's friends told The New York Times in response to some articles that John Markoff was writing he inadvertently gave his initials.</p></blockquote>

<p>There were a couple of ways that he was discovered. The first was the forensic analysis of the worm itself, and tracing that back to the original infection point. This sort of evidence shows where to look (the original infection), but it does not provide enough information to successfully prosecute. It is circumstantial so far, and given some careful sanitisation of the original box, it would be a very hard case to prove.</p>

<p>The far more damaging way that Morris was caught was via an OSINT case officer doing HUMINT collection (a reporter interviewing people about the worm). The journo managed to elicit information about the worm's author (his initials). This is the sort of extremely damaging information leakage that happens when there is poor OPSEC. There was no anti-interrogation training provided to the members of the Morris cell (i.e. all his friends who knew about the development of the worm).</p>

<h2>Deny everything. Admit nothing. Or, you know, not.</h2>

<blockquote><p>he did testify that he wrote the worm. He came in and testified, "I did it, and I'm sorry." I turned to my co-counsel and asked, "Should I prove he didn't do it or he's not sorry?"</p></blockquote>

<p>When the prosecution has to prove that you committed a felonious act, it is a lot easier for them when you <strong>confess</strong> on the stand. I can't second guess the decisions of Morris' legal counsel, but unless you are instructed to do so by your lawyer: STFU.</p>

<h2>The Morris Cell and "Need to know"</h2>

<blockquote><p>We talked to his friends. His friends were witnesses for us. They didn't have a choice.
There was a core group. ...one of the meetings where Robert Morris was discussing the worm occurred at a Legal Seafood in Kendall Square...
He talked about how it was developed, how it worked, what vulnerabilities it exploited. At one point he was at a meeting back at Harvard, he got so excited that he literally jumped up on a table pacing back and forth on the table explaining how it worked...</p></blockquote>

<p>The close friends of Robert Morris, the Morris Cell, were fully briefed on all aspects of the worm. Its capabilities, its functionality, and its author's real identity. None of the other members of the cell were actively exposed to the risks of the operation. They had no "need to know".</p>

<p>This failure to STFU, to properly compartment the design and development of the worm, was a key factor leading to his capture and prosecution. Fortunately, things worked out well for him, in the long run.</p>

<h2>How to evaluate "Need to know"</h2>

<p>The rule of thumb is: <em>if someone is actively sharing the risk, they have a need to know</em>. This need to know is, of course, restricted to only those aspects of the operation in which they are actively involved.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OPSEC isn't security through obscurity]]></title>
    <link href="http://grugq.github.com/blog/2013/11/04/opsec-isnt-security-through-obscurity/"/>
    <updated>2013-11-04T01:04:00+07:00</updated>
    <id>http://grugq.github.com/blog/2013/11/04/opsec-isnt-security-through-obscurity</id>
    <content type="html"><![CDATA[<h2>OPSEC revisited</h2>

<blockquote><p>The goal of OPSEC is to control information about your capabilities and intentions to keep them from being exploited by your adversary.</p></blockquote>

<p>In typical hacker fashion, the term OPSEC has come to mean more than just information about capabilities and intentions, but also personal information about the yourself.</p>

<h2>Kerckoff's Principle and OPSEC</h2>

<p>A common source for the idea that "security through obscurity is bad" is <a href="http://en.wikipedia.org/wiki/Kerckhoffs%27_principle">Kerckoffs' principle</a> which states that: <code>A cryptosystem should be secure even if everything about the system, except the key, is public knowledge</code>. OPSEC as a system of security is sometimes confused with "security through obscurity". This is not the case. Such thinking reflects a confusion of both the problem with opaque security systems and the foundations of OPSEC.</p>

<h2>OPSEC is a System</h2>

<p>The way to clear this confusion, I believe, is to point out that OPSEC is a security system, not any one specific practice. The system itself is open source, in that we know how and why the various techniques and practices work. For example, the tradecraft technique of a <a href="http://en.wikipedia.org/wiki/Dead_drop">dead drop</a> is public knowledge. The security of a dead drop is not that no one knows how they work, but rather the adversary does not know <strong>where</strong> a specific dead drop is locate, nor <strong>when</strong> that dead drop is being serviced (loaded or unload). That information, primarily the location of that dead drop, is the <strong>secret key</strong> to the dead drop security system. This information is what must remain secret for the dead drop to remain secure.</p>

<h2>Why OPSEC Works</h2>

<p>So OPSEC as a system of security does not violate Kerckoff's principle, and is not "security through obscurity". The specifics of any one application of OPSEC techniques provide security, but those are analogous to the private key to the system. If they are compromised, then security they provide will be be compromised.</p>
]]></content>
  </entry>
  
</feed>
