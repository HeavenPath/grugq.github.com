
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>In Search of OPSEC Magic Sauce - Hacker OPSEC</title>
  <meta name="author" content="the grugq">

  
  <meta name="description" content="Of Bomb Threats and Tor">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://grugq.github.com/blog/2013/12/21/in-search-of-opsec-magic-sauce">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Hacker OPSEC" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Hacker OPSEC</a></h1>
  
    <h2>STFU is the best policy.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:grugq.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/docs/">Docs</a></li>
  <li><a href="/presentations/">Presentations</a></li>
  <li><a href="/resources/">Resources</a></li>
  <li><a href="/contact/">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">In Search of OPSEC Magic Sauce</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-21T05:15:00+07:00" pubdate data-updated="true">Dec 21<span>st</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><h2>Of Bomb Threats and Tor</h2>

<p>Recently (December 16th, 2013) there was a <a href="http://www.thecrimson.com/article/2013/12/16/unconfirmed-reports-explosives-four-buildings/">bomb threat at Harvard University</a>, during finals week. The threat was a hoax, and the <a href="http://www.thecrimson.com/article/2013/12/17/student-charged-bomb-threat/">FBI got their man</a> that very night. The <a href="https://drive.google.com/file/d/0Bzt0K7_O4qyqUlEtd2pUWE42amM/edit?usp=sharing">affidavit is here</a>.</p>

<p>This post will look at the tools and techniques the operative used to attempt
to hide his actions, why he failed, and what he should&#8217;ve done to improve his
OPSEC. As a hint: I provided an outline of what he should&#8217;ve done 6 months
ago in <a href="http://grugq.github.io/blog/2013/06/13/ignorance-is-strength/">&#8220;<strong>ignorance is strength</strong>&#8221;</a>.</p>

<p><strong>Disclaimer:</strong> This post is to outline why OPSEC is so difficult to get right,
even for people who go to Harvard. I am not encouraging any illegal behavior,
but instead analyzing how OPSEC precautions can be so difficult to get right.
Don&#8217;t send bomb threats.</p>

<h3>Key Takeaways</h3>

<ol>
<li>The phases of an operation</li>
<li>Counterintelligence (&#8220;know your enemy&#8221;) as a factor in operational design</li>
<li>Avoid reducing the set of suspects

<ul>
<li>If all students are suspects, all one needs to do is avoid narrowing the pool of potential suspects</li>
</ul>
</li>
</ol>


<h2>Strategic Objectives: Avoid Final Exam</h2>

<p>Strategically, the principal behind this operation (Eldo Kim) was attempting to avoid taking
a Final Exam scheduled for the morning of December 16th. To accomplish his objectives
he designed an operation that would cause an evacuation of the building where he
was to take his final. Rather than recruit an agent
and delegate the execution of the operation, the principal decided to do it himself.</p>

<p>This was not an enlightened decision.</p>

<h2>The Structure of All Things (for values of Things = &#8220;Operations&#8221;)</h2>

<p>All offensive operations share a similar core structure. This structure has been
known for a long time in the military, but is rarely applied in other fields.
Operations have distinct phases that they move through as they progress from vague
idea, to concrete plan, through execution and, finally, onto the escape.</p>

<p>The outline framework for an operation, all of the phases, is the following:</p>

<ol>
<li>Target Selection</li>
<li>Planning (and Surveillance)</li>
<li>Deployment</li>
<li>Execution</li>
<li>Escape and Evasion</li>
</ol>


<p>This framework is frequently used when dissecting a terrorist attack post mortem,
allowing the security forces to identify the agents involved in each phase. Ideally,
the security forces want to remove the people involved in the <em>Target Selection</em>
and <em>Planning</em> stages. These people tend to be the principals, and are more
valuable than the agents who actually perpetrate the attack.</p>

<p>For hacker groups, the operational phases are rarely acknowledged, and followed
in an ad hoc manner. Primarily because few hackers are aware of them. It would be
beneficial for hackers to understand the structure of preparing an operation
thoroughly, but that is an issue we&#8217;ll address another day.</p>

<p>As an aside, it is worth noting that these operational phases apply to a
consultancy making a sale, providing a service, dropping a deliverable, and then
vanishing. ;)</p>

<h2>College Kids are Inexperienced, News at 11.</h2>

<p>All real criminals know that the most important part of an operation is the
get away, the <em>git</em> (as it used to be called). Of course, real criminals don&#8217;t
go to Harvard University (although there&#8217;s an argument to be made that some
graduate from there), and so poor Eldo Kim had no one to teach him the criticality
of the final stage of an operation: <strong>Escape and Evasion</strong>.</p>

<h2>Operation &#8220;Doomed to Failure&#8221;</h2>

<p>The operative used an ad hoc approach to his operational design, and as a result
he made a fatal error. Here is his operational plan:</p>

<ul>
<li>Obtain Tor Browser Bundle</li>
<li>Select target email addresses &#8220;randomly&#8221; [see para 11]</li>
<li>Compose email</li>
<li>For each target email address

<ul>
<li>Create new GuerillaMail &#8220;account&#8221;</li>
<li>Send email (<a href="https://www.guerrillamail.com/compose">using this</a>)</li>
</ul>
</li>
</ul>


<p>For security, the operative chose to rely on a pseudonymous email tool and the
Tor anonymity network. He used the Tor Browser Bundle on OSX rather
than the TAILS distribution (see: para 11). Provided he closed the tab between
each session, there should be no forensic evidence left on the laptop.</p>

<p><strong>NOTE:</strong> When using <strong>Tor Browser Bundle</strong> close all the tabs and exit the
application when you are done. The TBB will clean up thoroughly after itself,
<em>but only on exit</em>! When you are done, shut it down. Runa&#8217;s <a href="https://research.torproject.org/techreports/tbb-forensic-analysis-2013-06-28.pdf">paper</a> explores this in
detail.</p>

<h3>Phase 1: Target Selection</h3>

<p>The strategic target was the hall hosting the final exam. Tactically, the
principal selected &#8220;email addresses at random&#8221; to receive a bomb threat intended
to force an evacuation of the hall, along with a number of other cover locations.</p>

<h3>Phase 2: Planning</h3>

<p>This step appears to have been focused solely on the technical requirements of
masking the origination of the threatening emails. However, insufficient resources
were devoted to this phase, and therefore it was fundamentally flawed.</p>

<p>Here is the email he sent:</p>

<pre><code>shrapnel bombs placed in: 

science center 
sever hall 
emerson hall 
thayer hall 

2/4. guess correctly. 

be quick for they will go off soon
</code></pre>

<p>Clearly he intended to provide cover locations, and he attempted to prolong the
bomb search by suggesting that some locations where legitimately bomb free. It
is standard operating procedure for bomb threats to be investigated thoroughly
and in parallel.</p>

<h3>Phase 3: Deployment</h3>

<p>The operative chose to use GuerrillaMail to send the emails, and because
GuerrillaMail reveals the source IP of the sender, he also chose Tor to mask his
IP address. However, he used a monitored network to access Tor, which severely
limits the anonymity provided by Tor. This error was to prove fatal.</p>

<h3>Phase 4: Execution</h3>

<p>Kim used the Harvard University wifi network. To gain access, he had to login
with his username and password. The university monitors and logs all network
activity. This was the fatal error. He authenticated to the network, his IP was
used to access Tor, and this information was logged.</p>

<p>When the incident was investigated the FBI was able to pull the logs and determine
not just whether anyone had accessed Tor, but exactly <strong>who</strong> had accessed Tor.</p>

<h3>Phase 5: Escape and Evasion</h3>

<p>There was nothing at all done for this phase. It is worth noting that there is
little he could have done to prepare for an interview by seasoned professional
FBI interrogators. As an amateur, he stood approximately zero chance of surviving.</p>

<h2>Counterintelligence: Know your Adversary</h2>

<p>A study of the investigation methods used by the law enforcement officials
engaged to investigate bomb threats would have been beneficial for Mr Kim. He
would have realized that they would target the likely suspects, attempt to
narrow the suspect pool down to the minimum set, then start interviewing. The
more strongly the evidence points to a set of suspects, the more aggressive the
interviews will be. From &#8220;do you know anything about&#8230;&#8221; to &#8220;We have all the
evidence we need, why don&#8217;t you make it easy for yourself?&#8221;</p>

<p>Initially the suspects for the case would have been any student scheduled to
take an exam
at one of the targeted halls. This is doubtless a large number, and without any
specific information to go on, the chance of interviewing all of them is slim.
If, however, the FBI did interview all of them, the questioning would be general
and undirected, rather than specific and probing. An amateur, like Kim, who kept
his cool and simply denied any knowledge of the hoax would have had a reasonable
chance of evading suspicion.</p>

<p>Knowing the investigative techniques of his adversary would have allowed Kim to
design an operation that provided for a reliable escape and evasion phase. He
would have used an unmonitored network, in an unmonitored location near by the
school, to send his threats. This would have left the suspect pool extremely
large &#8211; &#8220;everyone&#8221;.</p>

<p>When planning an operation, know how the adversary will respond. This will allow
you to factor that response into your planning. If you do not know how your
adversary will respond, then their response will be a surprise. Do not allow
the reactive force to surprise you.</p>

<h2>There is no OPSEC magic sauce</h2>

<p>The content and context of the threat make it clear
that the originator of the emails was a student (or possibly a professor/TA trying
to avoid grading exams). The important thing to hide is <strong>which</strong> student, not
that it was a student. Therefore simply using a nearby cafe with free wifi should
have been sufficient to mask the specific identity of the operative. Assuming:</p>

<ul>
<li>there are cafes that do not know the operative by sight,</li>
<li>there are cafes that are not monitored by CCTV (wear a hat, don&#8217;t look up),</li>
<li>that he wore a simple disguise to reduce the recall of the witnesses (look generic), and</li>
<li>that a college kid in a cafe at 8am during Finals week is not unusual</li>
</ul>


<p>Using Tor from the college campus was a fatal error. The pool of suspects was
immediately reduced to &#8220;everyone that used Tor during the time the bomb threats
were sent&#8221;. Since Silk Road v1 has been shut down, that is obviously going to be
a small number.</p>

<h2>Lets call it half a win</h2>

<p>Strategically, the operation was successful. Eldo Kim will not have to take his
final exam. Or, indeed, other final exams he might not be prepared for. However,
it is hard to imagine this is the outcome he was hoping for.</p>

<p><strong>Suggested Reading</strong> <a href="http://www.forbes.com/sites/runasandvik/2013/12/18/harvard-student-receives-f-for-tor-failure-while-sending-anonymous-bomb-threat/">Runa&#8217;s analysis</a> of the Harvard Bomb Hoax</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">the grugq</span></span>

      








  


<time datetime="2013-12-21T05:15:00+07:00" pubdate data-updated="true">Dec 21<span>st</span>, 2013</time>
      


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/12/01/yardbirds-effective-usenet-tradecraft/" title="Previous Post: Yardbird's Effective Usenet Tradecraft">&laquo; Yardbird's Effective Usenet Tradecraft</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/12/21/codes-what-are-they-good-for/" title="Next Post: Codes, What Are They Good For?">Codes, What Are They Good For? &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/05/11/the-episode-17/">The Episode 17</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/13/new-yorks-finest-opsec/">New York's Finest OPSEC</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/10/a-fistful-of-surveillance/">A Fistful of Surveillance</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("thegrugq", , );
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <p>Follow <a href="http://twitter.com/thegrugq">@thegrugq</a></p>
  
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/grugq">@grugq</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'grugq',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - the grugq -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
