
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>In Search of OPSEC Magic Sauce - Hacker OPSEC</title>
  <meta name="author" content="the grugq">

  
  <meta name="description" content="Of Bomb Threats and Tor Recently (December 16th, 2013) there was a bomb threat at Harvard University, during finals week. The threat was a hoax, and &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://grugq.github.com/blog/2013/12/21/in-search-of-opsec-magic-sauce">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Hacker OPSEC" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Hacker OPSEC</a></h1>
  
    <h2>STFU is the best policy.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:grugq.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/docs/">Docs</a></li>
  <li><a href="/presentations/">Presentations</a></li>
  <li><a href="/resources/">Resources</a></li>
  <li><a href="/contact/">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">In Search of OPSEC Magic Sauce</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-21T06:34:00+07:00" pubdate data-updated="true">Dec 21<span>st</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><h1>Of Bomb Threats and Tor</h1>

<p>Recently (December 16th, 2013) there was a <a href="http://www.thecrimson.com/article/2013/12/16/unconfirmed-reports-explosives-four-buildings/">bomb threat at Harvard University</a>, during finals week. The threat was a hoax, and the <a href="http://www.thecrimson.com/article/2013/12/17/student-charged-bomb-threat/">FBI got their man</a> that very night. The <a href="https://drive.google.com/file/d/0Bzt0K7_O4qyqUlEtd2pUWE42amM/edit?usp=sharing">affidavit is here</a>.</p>

<p>This post will look at the tools and techniques the operative used to attempt
to hide his actions, why they failed, and what he should&#8217;ve done to improve his
OPSEC. As a hint: I provided an outline of what he should&#8217;ve done 6 months
ago in <a href="http://grugq.github.io/blog/2013/06/13/ignorance-is-strength/">&#8220;<strong>ignorance is strength</strong>&#8221;</a>.</p>

<h2>Strategic Objectives: Avoid Final Exam</h2>

<p>Strategically, the principal behind this operation (Eldo Kim) was attempting to avoid taking
a Final Exam scheduled for the morning of December 16th. To accomplish his objectives
he designed an operation that would cause an evacuation of the building where he
was to take his final. Rather than recruit an agent
and delegate the execution of the operation, the principal decided to do it himself.</p>

<p>This was not an enlightened decision.</p>

<h2>The Structure of Things (for values of Things = &#8220;Operations&#8221;)</h2>

<p>All offensive operations share a similar core structure. This structure has been
known for a long time in the military, but is rarely applied in other fields.
Operations have distinct phases that they move through as the progress from vague
idea, to concrete plan, thru execution and onto the escape.</p>

<p>The outline framework for an operation, all of the phases, is the following:</p>

<ol>
<li>Target Selection</li>
<li>Planning (and Surveillance)</li>
<li>Deployment</li>
<li>Execution</li>
<li>Escape and Evasion</li>
</ol>


<p>This framework is frequently used when discecting a terrorist attack post mortem,
allowing the security forces to identify the agents involved in each phase. Idealy,
the security forces want to remove the people involved in the <em>Target Selection</em>
and <em>Planning</em> stages. These people tend to be the principals, and are more
valuable than the agents who actually perpetrate the attack.</p>

<p>For hacker groups, the operational phases are rarely acknowledged, and followed
in an adhoc manner. Primarily because few hackers are aware of them. It would be
beneficial for hackers to understand the structure of preparing an operation
thoroughly, but that is an issue we&#8217;ll address another day.</p>

<p>As an aside, it is worth noting that these operational phases apply to a
consultancy making a sale, providing a service, dropping a deliverable, and then
vanishing. ;)</p>

<h2>College Kids are Inexperienced, News at 11.</h2>

<p>All real criminals know that the most important part of an operation is the
get away, the <em>git</em> (as it used to be called). Of course, real criminals don&#8217;t
go to Harvard University (although there&#8217;s an argument to be made that some
graduate from there), and so poor Eldo Kim had no one to teach him the criticality
of the final stage of an operation: <strong>Escape and Evasion</strong>.</p>

<h2>Operation &#8220;Doomed to Failure&#8221;</h2>

<h3>Target Selection</h3>

<p>The strategic target was the hall hosting the final exam. Tactically, the
principal selected &#8220;email addresses at random&#8221; to recieve a bomb threat intended
to force an evacuation of the hall.</p>

<h3>Planning</h3>

<p>This step appears to have been focussed solely on the technical requirements of
masking the origination of the threatening emails. However, insufficient resources
were devoted to this phase, and therefore it was fundamentally flawed. The
operative chose to use GuerrillaMail to send the emails, however as GuerrillaMail
includes the source IP of the sender, he also chose Tor to mask his IP address.</p>

<h3>Deployment and Execution</h3>

<p>The operative used an ad hoc approach to his operational design, and as a result
he made a fatal error. Here is his operational plan:</p>

<p>Use Tor to connect to GuerrillaMail. Send an email to a target email address.
Create a new account for GuerrillaMail</p>

<ul>
<li>Obtain Tor Browser Bundle</li>
<li>Select target email addresses &#8220;randomly&#8221; [see para 11]</li>
<li><p>Compose email:
  shrapnel bombs placed in:</p>

<p>  science center
  sever hall
  emerson hall
  thayer hall</p>

<p>  2/4. guess correctly.</p>

<p>  be quick for they will go off soon</p></li>
<li>For each target email address

<ul>
<li>Create new GuerillaMail &#8220;account&#8221;</li>
<li>Send email (<a href="https://www.guerrillamail.com/compose">using this</a>)</li>
</ul>
</li>
</ul>


<p>For security, the operative chose to rely on a pseudonymous email tool and the
Tor anonymity network. It is likely that he used the Tor Browser Bundle rather
than the TAILS distribution (see: para 11). Provided he closed the tab between
each session, there should be no forensic evidence left on the laptop.</p>

<p><strong>NOTE:</strong> When using <strong>Tor Browser Bundle</strong> close all the tabs and exit the
application when you are done. The TBB will clean up thoroughly after itself,
<em>but only on exit</em>! When you are done, shut it down.</p>

<h3>Escape and Evasion</h3>

<p>There was nothing at all done for this phase.</p>

<h2>Counterintelligence: Know your Adversary</h2>

<p>A study of the methods of investigation used by the law enforcement officials
engaged to investigate bomb threats would have been beneficial for Mr Kim. He
would have realised that they would target the likely suspects, attempt to
narrow the suspect pool down to the minimum set, then start interviewing. The
more strongly the evidence points to a set of suspects, the more aggressive the
interviews will be. From &#8220;do you know anything about&#8230;&#8221; to &#8220;We have all the
evidence we need, why don&#8217;t you make it easy for yourself?&#8221;</p>

<p>Initially the suspects for the case would have been any student scheduled to
take an exam
at one of the targeted halls. This is doubtless a large number, and without any
specific information to go on, the chance of interviewing all of them is slim.
If, however, the FBI did interview all of them, the questioning would be general
and undirected, rather than specific and probing. An amateur, like Kim, who kept
his cool and simply denied any knowledge of the hoax would have had a reasonable
chance of evading suspicion.</p>

<p>Knowing the investigative techniques of his adversary would have allowed Kim to
design an operation that provided for a reliable escape and evasion phase. He
would have used an unmonitored network, in an unmonitored location near by the
school, to send his threats. This would have left the suspect pool extremely
large &#8211; &#8220;everyone&#8221;.</p>

<p>When planning an operation, know how the adversary will respond. This will allow
you to factor that response into your planning. If you do not know how your
adversary will respond, then their response will be a surprise. Do not allow
the reactive force to surprise you.</p>

<h2>There is no OPSEC magic sauce</h2>

<p><strong>What He Should Have Done</strong> the content and context of the threat make it clear
that the originator of the emails was a student (or possibly a professor/TA trying
to avoid grading exams). The important thing to hide is <strong>which</strong> student, not
that it was a student. Therefore simply using a nearby cafe with free wifi should
have been sufficient to mask the specific identity of the operative. Assuming:</p>

<ul>
<li>there are cafe&#8217;s that do not know the operative by sight,</li>
<li>there are cafe&#8217;s that are not monitored by CCTV (where a hat, don&#8217;t look up),</li>
<li>that he wore a simple disguise to reduce the recall of the witnesses (look generic), and</li>
<li>that a college kid in a cafe at 8am during Finals week is not unusual</li>
</ul>


<p>Using Tor from the college campus was a fatal error. The pool of suspects was
immediately reduced to &#8220;everyone that used Tor during the time the bomb threats
were sent&#8221;. Since Silk Road v1 has been shut down, that is obviously going to be
a small number.</p>

<h2>Lets call it half a win</h2>

<p>Strategically, the operation was successful. Eldo Kim will not have to take his
final exam. Or, indeed, other final exams he might not be prepared for. However,
it is hard to imagine this is the outcome he was hoping for.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">the grugq</span></span>

      








  


<time datetime="2013-12-21T06:34:00+07:00" pubdate data-updated="true">Dec 21<span>st</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/ci/'>CI</a>, <a class='category' href='/blog/categories/harvard-bomb-hoax/'>Harvard Bomb Hoax</a>, <a class='category' href='/blog/categories/opsec/'>OPSEC</a>, <a class='category' href='/blog/categories/counterintelligence/'>counterintelligence</a>, <a class='category' href='/blog/categories/operational-design/'>operational design</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/12/01/yardbirds-effective-usenet-tradecraft/" title="Previous Post: Yardbird's Effective Usenet Tradecraft">&laquo; Yardbird's Effective Usenet Tradecraft</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/21/in-search-of-opsec-magic-sauce/">In Search of OPSEC Magic Sauce</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/01/yardbirds-effective-usenet-tradecraft/">Yardbird's Effective Usenet Tradecraft</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/22/challenges-for-hackers/">How to Win at Kung Fu and Hacking</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("thegrugq", , );
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <p>Follow <a href="http://twitter.com/thegrugq">@thegrugq</a></p>
  
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/grugq">@grugq</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'grugq',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - the grugq -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
